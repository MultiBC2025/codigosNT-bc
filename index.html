<!DOCTYPE html>
<html lang="es">
<head>
  <meta charset="UTF-8">
  <title>Buscar Correos</title>
</head>
<body>
  <h2>Buscar Correos de un Email</h2>
  <form id="searchForm">
    <label for="email">Correo a buscar:</label>
    <input type="email" id="email" required>
    <button type="submit">Buscar</button>
  </form>

  <h3>Resultados:</h3>
  <div id="results"></div>

  <script>
    document.getElementById('searchForm').addEventListener('submit', function(event) {
      event.preventDefault();
      const email = document.getElementById('email').value;
      fetch(`https://script.google.com/macros/s/AKfycbz7vAOIMgFCkOvhEHy9lYme_V8AOTRk9qJThRmB9uHFjeA7ZrtIBJZenlNao5wTj2BL/exec?email=${encodeURIComponent(email)}`)
        .then(response => response.json())
        .then(data => {
          const resultsDiv = document.getElementById('results');
          resultsDiv.innerHTML = '';
          data.forEach(item => {
            const div = document.createElement('div');
            div.innerHTML = `<strong>${item.subject}</strong> - ${item.date} <br> <a href="${item.link}" target="_blank">Ver Mensaje</a><br><hr>`;
            resultsDiv.appendChild(div);
          });
        });
    });
  </script>
</body>
</html>
